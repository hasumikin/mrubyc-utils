#
# "main" pseudo-component makefile.
#
# (Uses default behaviour of compiling all source files in directory, adding 'include' to include path.)

COMPONENT_DEPENDS := mrubyc
COMPONENT_EXTRA_CLEAN = SRCFILES

SRCDIR := $(PROJECT_PATH)/<%= mruby_lib_dir %>
SRCFILES := $(wildcard $(SRCDIR)/*.rb)
OBJS := $(notdir $(patsubst %.rb,%.h,$(SRCFILES)))

main.o: $(OBJS)

# xxx.h: $(PROJECT_PATH)/<%= mruby_lib_dir %>/<%= prefix %>_xxx.rb
# 	mrbc -E -B <%= prefix %>_xxx -o $@ $^
$(notdir $(patsubst %.rb,%.h,$(SRCDIR)/%.rb)): $(SRCDIR)/%.rb
	mrbc -E -B $(basename $@) -o $@ $^

.PHONY: $(OBJS)
